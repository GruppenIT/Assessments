root@vlxweb12:/var/www/assessment# sudo -u postgres psql -d assessment_db << 'EOF'
DO $$
BEGIN
    IF NOT EXISTS (
        SELECT 1 FROM information_schema.columns
        WHERE table_name = 'tipos_assessment'
        AND column_name = 'email_destinatarios'
    ) THEN
        ALTER TABLE tipos_assessment
        ADD COLUMN email_destinatarios TEXT;

        COMMENT ON COLUMN tipos_assessment.email_destinatarios IS
        'E-mails que receberÃ£o alertas de novos leads';

        RAISE NOTICE 'Coluna adicionada em tipos_assessment';
    ELSE
        RAISE NOTICE 'Coluna jÃ¡ existe em tipos_assessment';
    END IF;
END $$;
EOF
NOTICE:  Coluna adicionada em tipos_assessment
DO
root@vlxweb12:/var/www/assessment# sudo -u postgres psql -d assessment_db -c "\d tipos_assessment" | grep email
 email_destinatarios | text                        |           |          |
root@vlxweb12:/var/www/assessment# sudo supervisorctl restart assessment
assessment: stopped
assessment: started
root@vlxweb12:/var/www/assessment# venv/bin/python diagnosticar_assessment_criado.py
ENV_LOADER: Carregadas variÃ¡veis de .env
INFO:root:Blueprint de projetos registrado com sucesso
INFO:root:Blueprint de assessments registrado com sucesso
INFO:root:Blueprint de parÃ¢metros registrado com sucesso
INFO:root:Blueprint de assessment pÃºblico registrado com sucesso
INFO:root:Portal do cliente registrado com sucesso
INFO:root:Blueprint de leads registrado com sucesso
INFO:root:ConfiguraÃ§Ãµes padrÃ£o inicializadas

ðŸ” DIAGNÃ“STICO DO ASSESSMENT CRIADO
======================================================================

ðŸ“‹ Assessment PÃºblico #93
   tipo_assessment_id: 3
   token: 345CuhGNQ7M5EUoMXEfmZ9eDVbqNnPcUSjMM_qAtdyY
   data_inicio: 2025-10-13 23:03:21.441500
   data_conclusao: 2025-10-13 23:03:37.880319

ðŸ‘¤ Dados do Respondente:
   nome: Ricardo Souza
   email: ricardo@ramotransp.com.br
   empresa: Ramo Transportadora LTDA

ðŸ“Š Respostas:
   Total de respostas: 7

ðŸ” Tipo de Assessment:
   âœ— Tipo NÃƒO encontrado (tipo_assessment Ã© None)
/var/www/assessment/diagnosticar_assessment_criado.py:40: LegacyAPIWarning: The Query.get() method is considered legacy as of the 1.x series of SQLAlchemy and becomes a legacy construct in 2.0. The method is now available as Session.get() (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
  tipo = TipoAssessment.query.get(assessment.tipo_assessment_id)
   âœ— Tipo ID 3 nÃ£o existe no banco

ðŸŽ¯ Lead:
   âœ— NENHUM LEAD CRIADO

â“ PossÃ­veis motivos:
   - Tipo de assessment invÃ¡lido

======================================================================

root@vlxweb12:/var/www/assessment#